"use strict";

// ‚ñ∂ start buttonÏùÑ ÎàåÎ†ÄÏùÑÎïå.
const playBtn = document.querySelector(".play-btn");
const stopBtn = document.querySelector(".stop-btn");
const bgm = document.querySelector(".bgm");
const gameLule = document.querySelector(".game-rule");

playBtn.addEventListener("click", () => {
  printTimer(11);
  onChangeBtn();
  carrotOnDisplay();
  bugOnDisplay();
  bgm.innerHTML = `<audio src="./sound/bg.mp3" autoplay></audio>`;
  gameLule.style.display = "none";
});

// - Ïû¨ÏÉùÎ≤ÑÌäº Ï§ëÏßÄÎ≤ÑÌäºÏúºÎ°ú Î∞îÎÄåÍ∏∞
function onChangeBtn() {
  playBtn.style.display = "none";
  stopBtn.style.display = "block";
}

const modal = document.querySelector(".modal");
const modalDesc = document.querySelector(".modal-desc");
const itemsBox = document.querySelector(".items-box");

//   * Ï§ëÏßÄÎ≤ÑÌäº ÎàåÎ†ÄÏùÑÎïå, replay Î™®Îã¨Ï∞ΩÏù¥ ÎùÑÏö∞Í∏∞.
//   * ÌÉÄÏù¥Î®∏Í∞Ä Ïà´Ïûê Í∑∏ÎåÄÎ°ú Î©àÏ∂îÍ∏∞.
//   * Î≤ÑÍ∑∏ÏôÄ ÎãπÍ∑ºÏù¥ ÎçîÏù¥ÏÉÅ ÌÅ¥Î¶≠ÎêòÏßÄ ÏïäÍ≤å ÎßåÎì†Îã§.
stopBtn.addEventListener("click", (event) => {
  getModalBox("replay");
  itemsRemove("all");
  clearInterval(timerinterval);
  bgm.innerHTML = `<audio src="./sound/alert.wav" autoplay></audio>`;
});

function getModalBox(showMessage) {
  modal.style.display = "flex";
  switch (showMessage) {
    case "win":
      modalDesc.textContent = "YOU WINü•≥";
      break;
    case "lost":
      modalDesc.textContent = "YOU LOSTüò±";
      break;
    case "replay":
      modalDesc.textContent = "Replayü•ï";
      break;
  }
}

function hideModalBox() {
  modal.style.display = "none";
}

const replayBtn = document.querySelector(".replay-btn");

//    * replay Î≤ÑÌäº ÎàÑÎ•¥Î©¥ Î™®Îã¨Ï∞Ω ÏÇ¨ÎùºÏßÄÍ≥† Îã§Ïãú Í≤åÏûÑÏãúÏûë.
replayBtn.addEventListener("click", () => {
  printTimer(11);
  onChangeBtn();
  carrotOnDisplay();
  bugOnDisplay();
  hideModalBox();
  countItems("reset");
  bgm.innerHTML = `<audio src="./sound/bg.mp3" class="bgm" autoplay></audio>`;
});

// - ÌÉÄÏù¥Î®∏ ÏãúÍ∞Ñ Ï§ÑÏñ¥Îì§Í∏∞.
// ÏïÑÏ£º Ïñ¥Î†µÍ≤å ÎßåÎì†ÌÉÄÏù¥Î®∏....Í∏∞ÎÖêÏúºÎ°ú ÎÇ®Í∏∞Í∏∞...
// const timer = document.querySelector('.timer');
// function startTimer() {
//   let time = 1000;
//   let num = 10;
//   for(let i = 1; i <= 10; i++){
//     if(i * 1000 == time) {
//       setTimeout(function(){timer.innerHTML = `0:${num--}`}, time);
//       time = time + 1000;
//     } ;
//   };
// };

const timer = document.querySelector(".timer");
let timerinterval;
function printTimer(num) {
  timerinterval = setInterval(() => {
    if (num > 0) {
      timer.innerHTML = `0:${--num}`;
    } else if (num == 0) {
      clickOnBug("bug");
    }
  }, 1000);
}

// - ÎãπÍ∑ºÍ≥º Î≤ÑÍ∑∏ 15Í∞úÏî© ÎßåÎì§Í∏∞
// - ÎãπÍ∑ºÍ≥º Î≤ÑÍ∑∏ 15Í∞úÍ∞Ä ÎûúÎç§ÏúºÎ°ú Î∞∞ÏπòÎêòÍ∏∞.

const itemsBoxWidth = itemsBox.offsetWidth;
const itemsBoxHeight = itemsBox.offsetHeight;

function carrotOnDisplay() {
  for (let i = 1; i <= 15; i++) {
    const newCarrot = document.createElement("img");
    itemsBox.appendChild(newCarrot);
    newCarrot.setAttribute("src", "./img/carrot.png");
    newCarrot.setAttribute("class", `carrot`);
  }
  const carrotAll = document.querySelectorAll(".carrot");
  carrotAll.forEach((index) => {
    carrotAll[0].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[1].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[2].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[3].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[4].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[5].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[6].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[7].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[8].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[9].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[10].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[11].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[12].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[13].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    carrotAll[14].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
  });
}

function bugOnDisplay() {
  for (let i = 1; i <= 15; i++) {
    const newBug = document.createElement("img");
    itemsBox.appendChild(newBug);
    newBug.setAttribute("src", "./img/bug.png");
    newBug.setAttribute("class", `bug`);
  }
  const BugAll = document.querySelectorAll(".bug");
  BugAll.forEach((index) => {
    BugAll[0].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[1].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[2].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[3].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[4].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[5].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[6].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[7].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[8].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[9].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[10].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[11].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[12].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[13].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
    BugAll[14].style.transform = `translate(${Math.floor(
      Math.random() * (itemsBoxWidth - 80 + 1) + 1
    )}px,${Math.floor(Math.random() * (itemsBoxHeight - 60 + 1) + 1)}px)`;
  });
}

// - ÎãπÍ∑ºÏù¥ ÌÅ¥Î¶≠ ÎêòÍ∏∞.
//   * ÎãπÍ∑ºÏù¥ ÌÅ¥Î¶≠Îê†Îïå, ÌÅ¥Î¶≠Îêú ÎãπÍ∑º ÎãπÍ∑º ÏàòÎßåÌÅº Ïπ¥Ïö¥ÌÑ∞ Ï§ÑÏñ¥Îì§Í∏∞.
const counter = document.querySelector(".counter");
const clickSound = document.querySelector(".click-sound");

let counterNumber = 0;
function countItems(reset) {
  if (reset == "reset") {
    counterNumber = 0;
    counter.textContent = counterNumber;
  } else {
    counterNumber = +counterNumber;
    counter.textContent = ++counterNumber;
  }
}

function itemsRemove(target) {
  if (target == "all") {
    while (itemsBox.firstChild) {
      itemsBox.removeChild(itemsBox.firstChild);
    }
  } else {
    target.remove();
  }
}

itemsBox.addEventListener("click", (event) => {
  const target = event.target.className;
  clickOnCarrot(target);
  if (target != "items-box") {
    clickOnBug(target);
    itemsRemove(event.target);
  }
  // if(counter.textContent < 15 && timer.textContent == '0:0') {
  //   clickOnBug('bug');
  // };
});

function clickOnCarrot(target) {
  if (target === "carrot") {
    countItems();
    userWin();
    clickSound.innerHTML = `<audio src="./sound/carrot_pull.mp3" autoplay></audio>`;
  }
}

//   * Î≤ÑÍ∑∏Î•º ÌÅ¥Î¶≠ÌñàÏùÑÎïå, lost Î™®Îã¨Ï∞Ω ÎùÑÏö∞Í∏∞
//   * ÌÉÄÏù¥Î®∏ 00:00ÏúºÎ°ú Î∞îÎÄåÍ∏∞.
//   * Î≤ÑÍ∑∏ÏôÄ ÎãπÍ∑ºÏù¥ ÎçîÏù¥ÏÉÅ ÌÅ¥Î¶≠ÎêòÏßÄ ÏïäÍ≤å ÌïòÍ∏∞.
function clickOnBug(target) {
  if (target === "bug") {
    getModalBox("lost");
    itemsRemove("all");
    clearInterval(timerinterval);
    clickSound.innerHTML = `<audio src="./sound/bug_pull.mp3" autoplay></audio>`;
    bgm.innerHTML = `<audio src="./sound/alert.wav" autoplay></audio>`;
  }
}

//   * ÎãπÍ∑ºÏùÑ 10Ï¥à ÎÇ¥Ïóê Îã§ ÌÅ¥Î¶≠ÌñàÏùÑÎïå
//      ‚óè win Î™®Îã¨Ï∞ΩÎùÑÏö∞Í∏∞.
function userWin() {
  if (counterNumber === 15 && timer.textContent != "0:0") {
    getModalBox("win");
    itemsRemove("all");
    clearInterval(timerinterval);
    bgm.innerHTML = `<audio src="./sound/game_win.mp3" autoplay></audio>`;
  }
}

// üìå Ïñ¥Î†§Ïõ†ÎçòÏ†ê!
// üëâüèº items-boxÏïàÏóê ÏÉàÎ°úÎßåÎì† ÎãπÍ∑ºÍ≥º Î≤ÑÍ∑∏Î•º ÎûúÎç§ÏúºÎ°ú Î∞∞ÏπòÌïòÎäî Í∏∞Îä•.
// Ìï¥Í≤∞: 1. Î∞òÎ≥µÎ¨∏ÏúºÎ°ú items-boxÏïàÏóê img.carrotÍ≥º img.bug ÌÉúÍ∑∏ 15Í∞úÏî© ÎßåÎì§Í∏∞.
//      2. querySelectorAllÎ°ú Î™®Îì† .carrotÍ≥º .bugÎ•º Í∞ÄÏ†∏Ïò§Í∏∞.
//      3. Í∞ÄÏ†∏Ïò® 15Í∞ú ÌÉúÍ∑∏Ïóê Í∞ÅÍ∞Å, css translate Í∞íÏùÑ ÎûúÎç§ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÍ∏∞.
// Îã®Ï†ê: ÏΩîÎìú ÎÑàÎ¨¥ Í∏∏Îã§ Ï¥ù 30Ï§ÑÏù¥ÏÉÅ.

// üëâüèº (Ï§ëÏßÄÎ≤ÑÌäº || Î≤ÑÍ∑∏ || ÎãπÍ∑º Î™®Îëê) ÌÅ¥Î¶≠ÌñàÏùÑÎïå ÌÉÄÏù¥Î®∏Í∞Ä Î©àÏ∂îÎäî Í∏∞Îä•.
// Ìï¥Í≤∞: 1. Ï≤òÏùåÏóê setTimeoutÎ°ú ÎßåÎì† ÌÉÄÏù¥Î®∏Î°úÎäî clearTimeout ÏÇ¨Ïö©Ìï†Ïàò ÏóÜÏñ¥ÏÑú Ï≤òÏùåÏóê ÎßåÎì† ÌÉÄÏù¥Î®∏Î•º setIntervalÎ°ú Îã§ÏãúÎßåÎì¨.
//      2. setIntervalÎ°ú ÌÉÄÏù¥Î®∏Î•º Îçî Í∞ÑÎã®ÌïòÍ≤å ÎßåÎì§Í≥† clearIntervalÎ°ú ÏöîÏÜåÎ•º ÌÅ¥Î¶≠Ìï†Îïå ÏÉùÏÑ±Ìïú ÌÉÄÏù¥Î®∏ Î©àÏ∂îÍ≤åÌï®.
// Îã®Ï†ê: ÏóÜÎäîÎìØ?

// üëâüèº Î¶¨ÌîåÎ†àÏù¥Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌñàÏùÑÎïå ÌÉÄÏù¥Î®∏Î•º Ï¥àÍ∏∞Ìôî ÌïòÎäî Í∏∞Îä•.
// Ìï¥Í≤∞: 1. Ï≤òÏùåÏóê ÎßåÎì† ÌÉÄÏù¥Î®∏ Í≤ΩÏö∞, replaybtnÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Ï≤òÏùåÏóê playbtnÏùÑ ÌÅ¥Î¶≠ÌñàÏùÑÎïå ÏãúÏûëÌñàÎçò ÌÉÄÏù¥Î®∏Í∞Ä Î©àÏ∂îÏßÄ ÏïäÏïÑÏÑú,
//         playbtnÌÅ¥Î¶≠Ïãú Î≥¥Ïó¨Ï°åÎçò ÌÉÄÏù¥Î®∏Ïà´ÏûêÏôÄ, replaybtnÌÅ¥Î¶≠Ïãú Î≥¥Ïó¨Ï°åÎçò ÌÉÄÏù¥Î®∏Ïà´ÏûêÍ∞Ä Í≤πÏ≤òÏÑú ÎÇòÏôîÏùå.
//      2. clearIntervalÎ°ú ÌÉÄÏù¥Î®∏ Î©àÏ∂îÍ≤åÌïòÍ≥†, ÌÉÄÏù¥Î®∏Ìï®ÏàòÏóê Ïù∏Ïûê(ÌÉÄÏù¥Î®∏Ïà´Ïûê)Î•º Î∞õÏïÑÏôÄ ÎßåÎì§ÏóàÎçîÎãà Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú Îã§Ïãú Ï¥àÍ∏∞ÌôîÎê®.
// Ïû•Ï†ê: Ïù∏ÏûêÎ•º Î∞õÏïÑÏò¨ Ïàò ÏûàÏúºÎãà ÌÉÄÏù¥Î®∏ Ïà´ÏûêÎ•º ÏõêÌïòÎäîÎç∞Î°ú ÏÑ§Ï†ïÍ∞ÄÎä•.
// Îã®Ï†ê: ÏóÜÎäîÎìØ.

// üëâüèº üò± (ÌÉÄÏù¥Î®∏ == 0:0 && Ïπ¥Ïö¥ÌÑ∞ != 15) Ï°∞Í±¥ÏùºÎïå, LOST Î™®Îã¨Ï∞Ω ÎùÑÏö∞ÎäîÍ≤É.
// Ìï¥Í≤∞: 1. Ï≤´Î≤àÏß∏ Î∞©Î≤ï, ÌÉÄÏù¥Î®∏Ïùò Ïà´ÏûêÍ∞Ä 0ÏùºÎïå  LOST Ìï®Ïàò Ìò∏Ï∂ú.
//      2. ÎëêÎ≤àÏß∏ Î∞©Î≤ï, ÏöîÏÜåÍ∞Ä ÌÅ¥Î¶≠Îê†Îïå (ÌÉÄÏù¥Î®∏ == 0:0 && Ïπ¥Ïö¥ÌÑ∞ != 15)Ïù¥Î©¥ LOSTÌï®Ïàò Ìò∏Ï∂ú.
// Îã®Ï†ê: ÎëêÎ≤àÏß∏ Î∞©Î≤ïÏùÄ ÎãπÍ∑ºÏùÑ ÌÅ¥Î¶≠ÌñàÏùÑÎïå, (ÌÉÄÏù¥Î®∏ == 0:0 && Ïπ¥Ïö¥ÌÑ∞ != 15) Ïù¥ Ï°∞Í±¥Ïù¥Ïó¨Ïïº LOST Ìï®ÏàòÍ∞Ä Ìò∏Ï∂úÎêúÎã§.

// üëâüèº üò± (ÌÉÄÏù¥Î®∏ != 0:0 && Ïπ¥Ïö¥ÌÑ∞ == 15) Ï°∞Í±¥ÏùºÎïå, WIN Î™®Îã¨Ï∞Ω ÎùÑÏö∞ÎäîÍ≤É.
// Ìï¥Í≤∞: 1. (ÌÉÄÏù¥Î®∏ != 0:0 && Ïπ¥Ïö¥ÌÑ∞ == 15)Ï°∞Í±¥Ïù¥ ÎßûÏùÑÎïå WIN Î™®Îã¨Ï∞Ω ÎùÑÏö∞Îäî WINÌï®ÏàòÎ•º ÎßåÎì§Í≥†,
//      2. items-boxÎ•º ÌÅ¥Î¶≠ÌñàÏùÑÎïå ÌÅ¥Î¶≠Îêú ÌÉÄÍ≤üÏùÑ Ïù∏ÏûêÎ°ú Î∞õÎäî clickOnCarrotÏΩúÎ∞±Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥†,
//      3. clickOnCarrotÏùò Ïù∏Ïûê(ÌÅ¥Î¶≠ÎêúÌÉÄÍ≤üÏù¥)Í∞Ä carrotÏù¥Î©¥ WINÌï®ÏàòÎ•º Ìò∏Ï∂ú.
// Îã®Ï†ê: ÏΩúÎ∞±ÏßÄÏò•...?
